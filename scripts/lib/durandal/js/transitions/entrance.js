define(["durandal/system","durandal/composition","jquery"],function(e,t,n){function i(e,t){e.classList.remove(t?"entrance-in-fade":"entrance-in"),e.classList.remove("entrance-out")}var r=100,o={left:"0px",opacity:1},a={left:"",top:"",right:"",bottom:"",position:"",opacity:""},s=navigator.userAgent.match(/Trident/)||navigator.userAgent.match(/MSIE/),c=!1,u="Webkit Moz O ms Khtml".split(" "),l=document.createElement("div");if(void 0!==l.style.animationName&&(c=!0),!c)for(var d=0;d<u.length;d++)if(void 0!==l.style[u[d]+"AnimationName"]){c=!0;break}c?s?e.log("Using CSS3/jQuery mixed animations."):e.log("Using CSS3 animations."):e.log("Using jQuery animations.");var f=function(t){return e.defer(function(e){function u(){e.resolve()}function l(){t.keepScrollPosition||n(document).scrollTop(0)}function d(){l(),t.triggerAttach(),c?(i(t.child,g),t.child.classList.add(g?"entrance-in-fade":"entrance-in"),setTimeout(function(){i(t.child,g),t.activeView&&i(t.activeView,g),v.css(a),u()},f)):v.animate(o,{duration:f,easing:"swing",always:function(){v.css(a),u()}})}if(t.child){var f=t.duration||500,v=n(t.child),g=!!t.fadeOnly,p={display:"block",opacity:0,position:"absolute",left:g||c?"0px":"20px",right:0,top:0,bottom:0};v.css(p),t.activeView?c&&!s?(i(t.activeView,g),t.activeView.classList.add("entrance-out"),setTimeout(d,r)):n(t.activeView).fadeOut({duration:r,always:d}):d()}else n(t.activeView).fadeOut(r,u)}).promise()};return f});